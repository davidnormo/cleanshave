!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.shave=e()}(this,function(){var shave={};return shave.escape=function(t){return"string"!=typeof t?t:t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/["]/g,"&quot;").replace(/'/g,"&#039;")},shave.contextStack=[],shave.setContextStack=function(t,e){var a=t;e.forEach(function(t){try{a=a[t]}catch(e){return!1}a instanceof Array?(this.contextStack=a.slice(0),this.contextStack.reverse()):a&&this.contextStack.push(a)},this)},shave.clearContextStack=function(data,key){for(var i=key.length-1;i>=0;){try{var context=eval("data."+key.join("."))}catch(e){}if(context instanceof Array)return void(this.contextStack=[]);context&&this.contextStack.pop(),key.pop(),i--}},shave.resolve=function(tag,data){for(var stack=void 0!==data?[data]:this.contextStack,i=stack.length-1;i>=0;){var result,data=stack[i];if("."===tag.key[0])result=data;else try{result=eval("data."+tag.key.join("."))}catch(e){}if(void 0!==result&&result)return result;i--}return""},shave.section=function(parent,func,data,key,inverted){inverted=inverted||!1,this.setContextStack(data,key);var isValid=function(t){return t instanceof Array&&(t=0!==t.length),inverted?!t:!!t},sectionValue;try{sectionValue=eval("data."+key.join("."))}catch(e){if(!inverted)return!1;sectionValue=!1}func=func.bind(this),sectionValue instanceof Array&&!inverted?sectionValue.forEach(function(t){parent.appendChild(func(t)),this.contextStack.pop()},this):isValid(sectionValue)&&parent.appendChild(func(data)),this.clearContextStack(data,key)},shave.append=function(t,e){var a=document.createElement("div");a.innerHTML=t;for(var n=0;n<a.childNodes.length;n++)e.appendChild(a.childNodes[n])},shave.a=function(t,e){return t.appendChild(e),t},shave.c=function(t){return t.cloneNode(!0)},shave});