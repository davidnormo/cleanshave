!function(e,t){"function"==typeof define&&define.amd?define(["require"],t):"object"==typeof exports?module.exports=t(require):e.shave=t()}(this,function(require){var shave={};return shave.require=require,shave.escape=function(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/["]/g,"&quot;").replace(/'/g,"&#039;")},shave.contextStack=[],shave.setContextStack=function(e,t){var n=e;t.forEach(function(e){try{n=n[e]}catch(t){return!1}n instanceof Array?(this.contextStack=n.slice(0),this.contextStack.reverse()):n&&this.contextStack.push(n)},this)},shave.clearContextStack=function(data,key){for(var i=key.length-1;i>=0;){try{var context=eval("data."+key.join("."))}catch(e){}if(context instanceof Array)return void(this.contextStack=[]);context&&this.contextStack.pop(),key.pop(),i--}},shave.resolve=function(tag,data){for(var stack=void 0!==data?[data]:this.contextStack,i=stack.length-1;i>=0;){var result,data=stack[i];if("."===tag.key[0])result=data;else try{result=eval("data."+tag.key.join("."))}catch(e){}if(void 0!==result&&result)return result;i--}return""},shave.section=function(parent,func,data,key,inverted){inverted=inverted||!1,this.setContextStack(data,key);var isValid=function(e){return e instanceof Array&&(e=0!==e.length),inverted?!e:!!e},sectionValue;try{sectionValue=eval("data."+key.join("."))}catch(e){if(!inverted)return!1;sectionValue=!1}func=func.bind(this),sectionValue instanceof Array&&!inverted?sectionValue.forEach(function(e){parent.appendChild(func(e)),this.contextStack.pop()},this):isValid(sectionValue)&&parent.appendChild(func(data)),this.clearContextStack(data,key)},shave.append=function(e,t){var n=document.createElement("div");n.innerHTML=e;for(var a=0;a<n.childNodes.length;a++)t.appendChild(n.childNodes[a])},shave.a=function(e,t){return e.appendChild(t),e},shave.c=function(e){return e.cloneNode(!0)},shave.d=function(){return document.createDocumentFragment()},shave.e=function(e,t){return t?document.createTextNode(e):document.createElement(e)},shave.r=function(e,t){try{return this.require(e)(t)}catch(n){return document.createTextNode("")}},shave});