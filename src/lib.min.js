(function(e,t){if(typeof define==="function"&&define.amd){define([],t)}else if(typeof exports==="object"){module.exports=t()}else{e.shave=t()}})(this,function(){var shave={};shave.escape=function(e){if(typeof e!=="string")return e;return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/["]/g,"&quot;").replace(/'/g,"&#039;")};shave.contextStack=[];shave.setContextStack=function(e,t){var a=e;t.forEach(function(e){try{a=a[e]}catch(t){return false}if(a instanceof Array){this.contextStack=a.slice(0);this.contextStack.reverse()}else if(a){this.contextStack.push(a)}},this)};shave.clearContextStack=function(data,key){var i=key.length-1;while(i>=0){try{var context=eval("data."+key.join("."))}catch(e){}if(context instanceof Array){this.contextStack=[];return}if(context){this.contextStack.pop()}key.pop();i--}};shave.resolve=function(tag,data){var stack=data!==undefined?[data]:this.contextStack;var i=stack.length-1;while(i>=0){var result,data=stack[i];if(tag.key[0]==="."){result=data}else{try{result=eval("data."+tag.key.join("."))}catch(e){}}if(result!==undefined&&result){return result}i--}return""};shave.section=function(parent,func,data,key){this.setContextStack(data,key);var sectionValue;try{sectionValue=eval("data."+key.join("."))}catch(e){return false}func=func.bind(this);if(sectionValue instanceof Array){sectionValue.forEach(function(e){parent.appendChild(func(e));this.contextStack.pop()},this)}else if(sectionValue instanceof Object||!!sectionValue){parent.appendChild(func(data))}this.clearContextStack(data,key)};shave.append=function(e,t){var a=document.createElement("div");a.innerHTML=e;for(var n=0;n<a.childNodes.length;n++){t.appendChild(a.childNodes[n])}};shave.a=function(e,t){e.appendChild(t);return e};shave.c=function(e){return e.cloneNode(true)};return shave});